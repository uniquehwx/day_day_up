​                   

  基于DDD理论的电商业务中台的搭建





## 1、选题的研究意义及国内外研究现状综述，附参考文献。

~~快速开发操作，快速迭代。整合电商系统为一个大平台，为其他企业上中台做出理论实践指导。~~

### 研究意义

传统软件系统设计通常采用的是聚焦在以数据及数据样式为核心的系统建模方法。面向数据的建模方法是关系数据库理论的延续，关注的是数据表及数据表之间关系的设计，这是典型的面向技术实现的建模方法。面对日渐复杂的业务逻辑，这种设计方法欠缺灵活性与可扩展性，也无法更好地利用面向对象设计思想及设计模式，建立可重用的、可扩展的代码单元。尽管采用了微服务进行拆分，但是拆分的粒度，拆分的方式都缺少方法论。特别是争对于类似于~~网约车，快车，顺风车~~   C2C，聚划算*C2C*这里的C是一个group ，B2C 这种多条产品线的公用情况的服用无法打通。从而立起一个个独立的烟囱系统。有很多相同的逻辑代码，各自为营，加重了维护运营成本，也不符合面向对象的原则，高内聚低耦合。把公共的问题集中起来进行处理。

​        针对上述问题，DDD理论指导下的业务中台架构模式应运而生。领域驱动设计（Domain-Driven  Design，DDD是一种软件系统分析和设计的面向对象建模方法，如今已经发展成为了一种针对大型复杂系统的领域建模与分析方法。它完全改变了传统软件开发工程师针对数据库进行的建模方法，从而将要解决的业务概念和业务规则转换为软件系统中的类型以及类型的属性与行为，通过合理运用面向对象的封装、继承和多态等设计要素，降低或隐藏整个系统的业务复杂性，并使得系统具有更好的扩展性，以应对纷繁多变的现实业务问题。企业中台支撑了企业业务的数字化和企业数据的业务化，提升了企业的数字化运营能力，支撑了企业业务的灵活迭代。业务中台是就是通过制定企业级的标准和机制，把企业内不确定的业务规则和流程通过工业化、市场化和 IT 化的手段确定下来，有效降低企业内各组织主体的沟通成本，通过中心化能力的垂直化自主发展和水平化的服务延伸，最大程度提升企业内个人、各组织主体的协作效率。其核心原则为集中管控、分布式执行，打造强大基础支撑，灵活前端触角，敏捷接受市场化的需求和变化，将企业业务能力根植到社会大环境中，增强企业核心竞争力。业务中台的核心价值在于将传统 IT 把业务能力 IT 化的模式转变为将业务能力资产化的模式，从而提高业务敏捷性及响应市场的速度，进而达到企业提质转型、降本增效的目标。

### 国内外研究现状

2015 年 12 月，时任阿里巴巴集团 CEO 的张勇通过内部邮件宣布启动阿里巴巴 2018 年中台战略，构建符合 DT（Data Technology）时代的更具创新型和灵活性的“大中台，小前台”的组织机制和业务机制，实现管理模式创新。即将产品技术力量和数据运营能力从前台剥离，成为独立的中台，从而前台得到精简，保持足够的敏捷度，更好地满足业务发展和创新需求。 2017 年 5 月钟华出版的《企业 IT 架构转型之道：阿里巴巴中台战略思想和架构实战》详细阐述了业务中台是介于前台与后台之间的。书中列举了建设业务中台的一些原则：高内聚低耦合、数据完整性、可运营性、渐进性等。此书的出版推动了中台思想的发展和中台的建设。 与此同时，京东也在 2018 年 12 月宣布采用前台、中台和后台的组织架构。前台职能是理解和洞察客户需求和行为，通过产品创新和精细化运营服务客户，最终实现和提升客户价值。中台通过沉淀、迭代和组件化地输出服务于前台不同场景的通用能力，作为为前台业务运营和创新提供专业能力的共享平台。后台职能则提供基础设施建设、服务支持与风险管控，为中、前台提供保障。



### 参考文献

[1] 韩向东,季献忠.企业数字化转型八大发展趋势[J].管理会计研究,2021,4(Z1):21-26+101.

[2]周红林,曾春生,常欢欢.基于领域驱动的企业中台设计研究[J].现代信息科技,2019,3(20):79-81.

[3] 钟平 数字化转型的道与术  书籍  2020.09

[4]《领域驱动设计》[J].计算机教育, 2004(2):143-143. 
[5]胡俊霞.领域驱动设计在企业信息化系统中的应用研究[D].郑州:郑州大学,2017. 

[6] 周 红 林 , 曾 春 生 , 常 欢 欢 . 基 于 领 域 驱 动 的 企 业 中 台 设 计 研 究 [J]. 现 代 信 息 科
技,2019,3(20):79-81. 

[7]王赫.基于领域驱动的云产品管理系统的设计与实现[D].哈尔滨:哈尔滨工业大学,2018. 

[8]李娜.基于 Spring Cloud 微服务架构的应用[J].电子技术与软件工程, 2019(12):142-142. 
[9]郭致远,魏银珍.基于 Spring  Cloud 服务调用的设计与应用[J].信息技术与网络安全, 
2019(2):33. 

[10] Gulbulak Utku,Ertas Atila. Finite Element Driven Design Domain Identification of a Beating 
Left Ventricular Simulator.[J]. Bioengineering (Basel, Switzerland), 2019, 6(3). 

[11]宁小庚,  黄晓芳.  一种基于领域驱动设计划分微服务的方法[J].  西南科技大学学报, 
34(01):83-88. 

[12]Yin,  RK  Case  Study  Research:  Design  and  Methods[B]  Case  Study  Research:  Design  and 
Methods,2013 

[13]钟华.企业 IT 架构转型之道 阿里巴巴中台战略思想与架构实
战[M].北京：机械工业出版社，2017.

[14]庄璐,路学刚.微服务架构中认证与鉴权的探讨[J].金融科技时代, 2018, 278(10):40-42. 

[15]吴旭君.基于 Spring  Cloud 微服务架构的数据服务系统的实践 [J].计算机产品与流
通,2020(03):93. 

[16]易立江.基于领域驱动设计的证券交易系统的设计与实现[D].中国科学院大学(工程管理
与信息技术学院),2015. 

[17]Avram A.Domain-Driven Design Quickly[J].Lightning Source, 2007(06):63-65. 

[18]  云栖社区 . 关于 DDD 领域驱动设计的理论知识收集汇总 
[EB/OL].（2016-05-27）.https://yq.aliyun.com/articles/53436.

[19]  DDD领域驱动设计-充血模型、贫血领域模型
[EB/OL].（2016-05-27）.https://www.martinfowler.com/bliki/AnemicDomainModel.html.

[20]Avram A.Domain-Driven Design Quickly[J].Lightning Source, 2007(06):63-65. 

## 2、研究目标、研究内容和拟解决的关键问题。

### 研究目标：

~~电商业务中台系统，DDD驱动设计~~

领域驱动设计怎么结合中台系统架构去构建多产品线的电商业务

### 研究内容：



DDD领域驱动的设计:    怎么去确定微服务的边界确定，划分微服务的粒度。怎么去建立领域模型，再根据领域模型建立表结构

中台怎么落地： 中台内中心和应用怎么去划分，共性特征怎样去提取，基础服务的搭建需要些什么，特性的构建放在哪里。怎么把共性特征和特征有机的结合起来，共性和个性划分的维度怎么确定，以及各个划分的微服务怎么去交互，去保证一个高内聚低耦合的系统。



### 拟解决的关键问题

烟囱式应用的整合，整合资源，小步快跑。  主要是应对多产品线的设计问题，服务公用。

**（1）重复设计成本**

多产品线团队经常出现这样的画面：各个产品的设计师互相评审时发现自己费尽心力做的设计方案（功能、页面、组件或控件）别人已经做过，而且有的还比自己做得好。其实一个产品除了核心创意外，大部分功能都是通用性场景，不同产品线都在重复设计解决这些相似的问题。

**（2）重复开发成本**

重复设计的方案最后也得连累程序员背锅，不同产品线的研发加班码出来之后发现隔壁同学早就已经做过同样的事，脑门上仅剩的几根秀发瞬间又掉了几根。不仅产品线之间存在大量重复开发，产品线内部也一样。有个研发朋友说，其实他不怕改需求，最怕的是团队换设计师，每换一个设计师就得把同样的东西重新改一遍风格，然后重做一遍。

**（3）重复测试成本**

同样一个按钮，这个设计师的方案是直角，那个设计师的方案是圆角；同样一个toast，这个方案里是2秒，那个方案里是2.5秒……被这种细节折磨的测试妹子们，看设计师的眼神总是充满了杀意。

**（4）设计决策成本**

设计过程需要大量的决策，做什么、怎么做都需要严密的思考。重复的问题和简单问题浪费了大量的设计决策成本。

**（5）多团队维护成本**

多项目烟囱形树立，各自形成业务闭环，重复造轮子，已有系统的业务不得不额外维护一套，提升了人员维护成本

### 





## 3、拟采取的研究方法、技术路线、实验方案及其可行性分析。

### 研究方法：

#### **战略设计**

**1.** **产品愿景**

产品愿景是对产品顶层价值设计，对产品目标用户、核心价值、差异化竞争点等信息达成一

致，避免产品偏离方向。

事件风暴时，所有参与者针对每一个要点，在贴纸上写出自己的意见，贴到白板上。事件风

暴主持者会对每个贴纸，讨论并对发散的意见进行收敛和统一，形成产品愿景图。

**2.** **场景分析**

场景分析是从用户视角出发，探索业务领域中的典型场景，产出领域中需要支撑的场景分

类、用例操作以及不同子域之间的依赖关系，用以支撑领域建模。项目团队成员一起用事件风暴分析请假和考勤的用户旅程。根据不同角色的旅程和场景分

析，尽可能全面地梳理从前端操作到后端业务逻辑发生的所有操作、命令、领域事件以及外

部依赖关系等信息。

**3.** **领域建模**

领域建模是通过对业务和问题域进行分析，建立领域模型。向上通过限界上下文指导微服务

边界设计，向下通过聚合指导实体对象设计。

领域建模是一个收敛的过程，分三步：

第一步找出领域实体和值对象等领域对象；

第二步找出聚合根，根据实体、值对象与聚合根的依赖关系，建立聚合；

第三步根据业务及语义边界等因素，定义限界上下文

**4.** **微服务的拆分**

理论上一个限界上下文就可以设计为一个微服务，但还需要综合考虑多种外部因素，比如：

职责单一性、敏态与稳态业务分离、非功能性需求（如弹性伸缩、版本发布频率和安全等要

求）、软件包大小、团队沟通效率和技术异构等非业务要素。





#### **战术设计**

**1.** **分析微服务领域对象**

领域模型有很多领域对象，但是这些对象带有比较重的业务属性。要完成从领域模型到微服

务的落地，还需要进一步的分析和设计。在事件风暴基础上，我们进一步细化领域对象以及

它们的关系，补充事件风暴可能遗漏的业务和技术细节。

我们分析微服务内应该有哪些服务？服务的分层？应用服务由哪些服务组合和编排完成？领

域服务包括哪些实体和实体方法？哪个实体是聚合根？实体有哪些属性和方法？哪些对象应

该设计为值对象等。

**2.** **设计微服务代码结构**

根据 DDD 的代码模型和各领域对象所在的包、类和方法，我们可以定义出微服务的代

码结构，设计代码对象。





#### 中台中心梳理

第一步列出对应产品线的领域模型；

第二步划分出相同的领域模型；

第三步重新分类处理，把共性相同的整理归类，沉淀进中心；



#### 中台应用梳理

中心是对共性的提取公用，那么应用就是个性的优化，一般一个应用就对应着一个产品线。

1 需要定义好应用所依赖的中心模块

2 根据中心已有的接口可以快速的搭建应用系统



### 技术路线：

 中台微服务操作。基于PAAS，即平台即服务，搭建基础服务能力。平台中心架构采用主要微服务组件如下：

其中包含:

| SpringBoot     | 容器+MVC框架     |
| -------------- | ---------------- |
| SpringSecurity | 认证和授权框架   |
| MyBatisplus    | ORM框架          |
| RabbitMQ       | 消息队列         |
| Redis          | 分布式缓存       |
| nacos          | 服务注册配置中心 |
| openfeign      | 声明式远程调用   |
| pgsql          | 数据库           |
| elasticsearch  | 搜索引擎         |

### 实验方案：

根据研究方法，我们可以划分多个中心系统供不同多条产品线进行公用。根据产品线我们可以划分成对应产品线的多个应用，目前就两个一个to客户的商城和一个聚划算可以说是to团体。中心的话，大致统统的会有商品中心，库存中心，订单中心，支付中心，用户中心，会员中心

划分的话就六个中心和两个应用，一共8个微服务。

#### 微服务之间的交互：

彼此通过nacos进行服务注册，相关的配置文件也可以放在nacos中进行处理，通过openfeign进行相互之间的服务调用。通过RabbitMQ进行解耦，异步消峰操作。实现微服务之间的服务调用操作。redis用来做缓存处理和分布式锁，主要是涉及到锁定库存操作。SpringSecurity主要是构建用户中心的时候去解决资源权限处理的基于outh2的认证方式。

#### 微服务内的交互：

领域层：实体采用充血模式， 提取出聚合根的概念。领域模块中主要围绕聚合根进行操作处理。  

应用层：（application）进行对领域模块进行服务编排。

api 层 ： 向外暴露服务能力。   

基础服务层 ：采用的ORM框架是MyBatis-plus进行数据持久化。



## 4、选题的创新性或应用性。



应用性：提高公用性，高内聚低耦合。  把公用的模块抽离出来，并用了DDD去划分微服务，构建业务中台。给某企业同业务多产品线的一种较好的解决方案。



## 5、论文大纲。



## 6、研究计划进度、预期成果。



## 7、与本课题有关的工作积累、已有的研究工作成绩。